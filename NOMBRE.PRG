SET TALK OFF
SET ECHO OFF
SET DELE ON
SELECT 1
USE PRCTAS INDEX PRCTAS1
SELECT 2
USE PRPARTI INDEX PRPAR
REINDEX

SELECT PRCTAS
DO WHILE .NOT. EOF()
   IF DESCRI1<>SPACE(44)
      SKIP
      LOOP
   ENDIF
   STORE PARTID+GENERI+ESPECI+SUBESP TO WCODPAR
   SELECT PRPARTI
   SEEK WCODPAR
   IF FOUND()
      SELECT PRCTAS
      REPLACE DESCRI1 WITH PRPARTI.DESCRI
      REPLACE DESCRI2 WITH PRPARTI.DESCRI2
   ELSE
      SELECT PRCTAS
   ENDIF
   SKIP
ENDDO
CLOSE ALL
RETURN
